---
layout: post
title: Writeup - md5 calculator
---

지금까지 pwnable.kr에서 풀어본 문제들 중 점수가 가장 높았고, 그만큼 시간이 많이 걸렸다.

# MD5 Calculator

문제는 다음과 같다.

>We made a simple MD5 calculator as a network service.
Find a bug and exploit it to get a shell.
>Download : http://pwnable.kr/bin/hash
hint : this service shares the same machine with pwnable.kr web service

>Running at : nc pwnable.kr 9002


## 관찰

nc로 pwnable.kr에 접속해 어떤 일이 일어나는지 관찰해보자.

```
- Welcome to the free MD5 calculating service -  
Are you human? input captcha : 124274294  
>>> 124274294  
Welcome! you are authenticated.  
Encode your data with BASE64 then paste me!  
>>> asdf  
MD5(data) : 97f9d0857f1490352d489b8048da4ac9  
Thank you for using our service.
```
랜덤해보이는 어떤 숫자를 그대로 입력하면 다음 단계로 넘어가고,  base64 형태로 입력을 주면 MD5로 encryption된 결과가 나온다.

이제 hash 바이너리를 받아 IDA로 분석해보자.


![image](https://user-images.githubusercontent.com/27529056/75337402-4a3a5480-58d0-11ea-88a0-e3c8cde8aa44.png)


captcha라는 숫자가 `my_hash()`라는 함수를 통해서 나오는데, 
<!--stackedit_data:
eyJoaXN0b3J5IjpbMjA3Njk4NTY1OCwtMTE5NDIxMjkwNCwtND
AzNzk0NzA1XX0=
-->